/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * NewEmailDialogue.java
 *
 * Created on Dec 26, 2011, 1:51:38 PM
 */
package edu.coeia.wizard;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import javax.swing.JButton;
import javax.swing.JOptionPane;

/**
 *
 * @author Ahmed
 */

final class AddingEmailSourceDialog extends javax.swing.JDialog {

    public boolean cancelClicked = false;

    /** Creates new form NewEmailDialogue */
    public AddingEmailSourceDialog(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();

    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ProviderGroupButton = new javax.swing.ButtonGroup();
        GmailRadioButton = new javax.swing.JRadioButton();
        HotmailRadioButton = new javax.swing.JRadioButton();
        YahooRadioButton = new javax.swing.JRadioButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        UsernameTextField = new javax.swing.JTextField();
        OKButton = new javax.swing.JButton();
        CancelButton = new javax.swing.JButton();
        PasswordTextField = new javax.swing.JPasswordField();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Add New Email");

        ProviderGroupButton.add(GmailRadioButton);
        GmailRadioButton.setSelected(true);
        GmailRadioButton.setText("Gmail");

        ProviderGroupButton.add(HotmailRadioButton);
        HotmailRadioButton.setText("Hotmail");

        ProviderGroupButton.add(YahooRadioButton);
        YahooRadioButton.setText("Yahoo Plus!");

        jLabel1.setText("Username:");

        jLabel2.setText("Password:");

        UsernameTextField.setText("s2v2012@gmail.com");

        OKButton.setText("OK");
        OKButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                OKButtonActionPerformed(evt);
            }
        });

        CancelButton.setText("CANCEL");
        CancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CancelButtonActionPerformed(evt);
            }
        });

        PasswordTextField.setText("s2v123456789");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(GmailRadioButton)
                        .addGap(26, 26, 26)
                        .addComponent(HotmailRadioButton)
                        .addGap(18, 18, 18)
                        .addComponent(YahooRadioButton))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(PasswordTextField)
                            .addComponent(UsernameTextField, javax.swing.GroupLayout.DEFAULT_SIZE, 255, Short.MAX_VALUE)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(OKButton, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(CancelButton, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))))
                .addContainerGap(28, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(GmailRadioButton)
                    .addComponent(HotmailRadioButton)
                    .addComponent(YahooRadioButton))
                .addGap(28, 28, 28)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(UsernameTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel2)
                    .addComponent(PasswordTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(OKButton)
                    .addComponent(CancelButton))
                .addContainerGap(16, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

private void OKButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_OKButtonActionPerformed
// TODO add your handling code here:


    boolean visible = false;
    if (UsernameTextField.getText().isEmpty()) {
        JOptionPane.showMessageDialog(this, " Please Write Username", "Error", JOptionPane.ERROR_MESSAGE);
        visible = true;
        return;
    }
    //Set the email pattern string
    Pattern p = Pattern.compile(".+@.+\\.[a-z]+");
    //Match the given string with the pattern
    Matcher m = p.matcher(UsernameTextField.getText());
    //check whether match is found 
    boolean matchFound = m.matches();
    if (!matchFound) {
        JOptionPane.showMessageDialog(this, " Please Write A Valid Email Address", "Error", JOptionPane.ERROR_MESSAGE);
        visible = true;
        return;

    }
    if (!checkEmail(UsernameTextField.getText(), getProvider())){
        JOptionPane.showMessageDialog(this, " Please Write A Valid Email Provider", "Error", JOptionPane.ERROR_MESSAGE);
        visible = true;
        return;
    }

    if (PasswordTextField.getText().isEmpty()) {
        JOptionPane.showMessageDialog(this, " Please Write Password", "Error", JOptionPane.ERROR_MESSAGE);
        visible = true;
        return;
    }

    if (!GmailRadioButton.isSelected() && !HotmailRadioButton.isSelected() && !YahooRadioButton.isSelected()) {
        JOptionPane.showMessageDialog(this, " Please Choose an Email Provider", "Error", JOptionPane.ERROR_MESSAGE);
        visible = true;
        return;
    }

    cancelClicked = false;
    this.setVisible(visible);
}//GEN-LAST:event_OKButtonActionPerformed

private void CancelButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CancelButtonActionPerformed
// TODO add your handling code here:
    cancelClicked = true;
    this.setVisible(false);
}//GEN-LAST:event_CancelButtonActionPerformed

    private boolean checkEmail(String Email, EmailConfiguration.ONLINE_EMAIL_AGENT source) {

        int index = Email.lastIndexOf("@");
        if (index < 0) {
            return false;
        }
        String provider = Email.substring(index, Email.length());
        if (provider.equals("@gmail.com") && source == EmailConfiguration.ONLINE_EMAIL_AGENT.GMAIL) {
            return true;
        } else if (provider.equals("@hotmail.com") && source == EmailConfiguration.ONLINE_EMAIL_AGENT.HOTMAIL) {
            return true;
        } else if (provider.equals("@yahoo.com") && source == EmailConfiguration.ONLINE_EMAIL_AGENT.YAHOO) {
            return true;
        } else {
            return false;
        }


    }

    public String getUserName() {
        return UsernameTextField.getText().toString().trim();
    }

    public String getPassword() {
        return PasswordTextField.getText().toString().trim();
    }

    public EmailConfiguration.ONLINE_EMAIL_AGENT getProvider() {
        EmailConfiguration.ONLINE_EMAIL_AGENT provider = null;
        if (GmailRadioButton.isSelected()) {
            provider = EmailConfiguration.ONLINE_EMAIL_AGENT.GMAIL;
        } else if (YahooRadioButton.isSelected()) {
            provider = EmailConfiguration.ONLINE_EMAIL_AGENT.YAHOO;
        } else if (HotmailRadioButton.isSelected()) {
            provider = EmailConfiguration.ONLINE_EMAIL_AGENT.HOTMAIL;
        }
        return provider;
    }

    public JButton getCancelButton() {
        return CancelButton;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton CancelButton;
    private javax.swing.JRadioButton GmailRadioButton;
    private javax.swing.JRadioButton HotmailRadioButton;
    private javax.swing.JButton OKButton;
    private javax.swing.JPasswordField PasswordTextField;
    private javax.swing.ButtonGroup ProviderGroupButton;
    private javax.swing.JTextField UsernameTextField;
    private javax.swing.JRadioButton YahooRadioButton;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    // End of variables declaration//GEN-END:variables
}
